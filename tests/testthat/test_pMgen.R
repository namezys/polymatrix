context("pMgen")

test_that("pMgen.a without params", {
  random_matrix <- pMgen.a()
  expect_equal(random_matrix$dim, c(2, 3))
  expect_true(all(random_matrix$degree <= 3))
})

test_that("pMgen.b without params", {
  random_matrix <- pMgen.b()
  expect_equal(random_matrix$dim, c(2, 3))
  expect_true(all(random_matrix$degree <= 3))
})

test_that("pMgen.c without params", {
  random_matrix <- pMgen.c()
  expect_equal(random_matrix$dim, c(2, 3))
  expect_true(all(random_matrix$degree <= 3))
})

test_that("pMgen.d without params", {
  random_matrix <- pMgen.d()
  expect_equal(random_matrix$dim, c(2, 3))
  expect_true(all(random_matrix$degree <= 3))
})

test_that("pMgen.d with numerical data", {
  m = pMgen.d(2, 3, c(1, 2, 3, 10, 11))
  expect_equal(m$dim, c(2, 3))
  expect_equal(m$degree, matrix(0, 2, 3))
  expect_equal(m$dlist[[1]][[1]], polynomial(1))
  expect_equal(m$dlist[[2]][[1]], polynomial(2))
  expect_equal(m$dlist[[1]][[2]], polynomial(3))
  expect_equal(m$dlist[[2]][[2]], polynomial(10))
  expect_equal(m$dlist[[1]][[3]], polynomial(11))
  expect_equal(m$dlist[[2]][[3]], polynomial(1))
})

test_that("pMgen.d with polynomail data", {
  m = pMgen.d(2, 3, list(polynomial(c(1, 2)), polynomial(c(3, 4)), polynomial(c(2,3,4))))
  expect_equal(m$dim, c(2, 3))
  expect_equal(m$degree, matrix(c(1, 1, 2, 1, 1, 2), 2, 3))
  expect_equal(m$dlist[[1]][[1]], polynomial(c(1, 2)))
  expect_equal(m$dlist[[2]][[1]], polynomial(c(3, 4)))
  expect_equal(m$dlist[[1]][[2]], polynomial(c(2, 3, 4)))
})

test_that("pMgen without params", {
  random_matrix <- pMgen()
  expect_equal(random_matrix$dim, c(2, 3))
  expect_true(all(random_matrix$degree <= 3))
})
